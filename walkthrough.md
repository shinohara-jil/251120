# GASスクリプト導入・テスト手順

作成したスクリプトをGoogle Apps Script環境に導入し、動作確認を行う手順です。

## 1. スクリプトの導入

1.  [Google Apps Script](https://script.google.com/) にアクセスし、「新しいプロジェクト」を作成します。
2.  エディタが開いたら、デフォルトの `myFunction` 等を削除し、作成した `mail_to_sheet.gs` の内容をすべてコピー＆ペーストします。
3.  プロジェクト名を「メール自動転記」などに変更して保存します。

## 2. 初回実行と権限承認

1.  ツールバーの関数プルダウンから `main` を選択し、「実行」ボタンをクリックします。
2.  初回は「権限を確認」というダイアログが表示されるので、クリックします。
3.  アカウントを選択し、「詳細」>「（プロジェクト名）に移動（安全ではないページ）」>「許可」の順に進んで権限を承認します。
    *   ※Gmailとスプレッドシートへのアクセス権限が必要です。

## 3. 動作確認

1.  **テストメール送信**:
    *   宛先: `shinohara@jilinc.co.jp`
    *   件名: `入稿が完了しました`
    *   本文: テスト用の文章（100文字以上入力してサマリ機能も確認すると良いです）
2.  **スクリプト実行**:
    *   GASエディタで再度 `main` を実行します。
3.  **結果確認**:
    *   スプレッドシート (`1XO-56rbZtiwbCYpnObHMWxjUw50kqxhCATaEanr-x5`) の「シート1」に新しい行が追加されているか確認します。
    *   A列にNo、B列に差出人、C列に本文サマリが入っていることを確認します。
    *   Gmailで、処理したメールに `Processed` ラベルが付いているか確認します。

## 4. 運用

*   今回は「手動実行」とのことですので、転記を行いたいタイミングでGASエディタから `main` を実行するか、スプレッドシート上にボタンを作成してスクリプトを割り当てる等の方法で実行してください。
