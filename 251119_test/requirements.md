# 要件定義書: メール自動転記ツール (GAS)

## 概要
`shinohara@jilinc.co.jp` 宛に届く「入稿が完了しました」という件名のメールを検知し、指定されたGoogleスプレッドシートに内容を自動転記するGoogle Apps Script (GAS) ツール。

## 機能要件

### 1. メール検索・取得
- **検索対象**: Gmail (`shinohara@jilinc.co.jp`)
- **検索条件**:
    - 宛先 (To): `shinohara@jilinc.co.jp`
    - 件名 (Subject): `入稿が完了しました` (部分一致か完全一致か要確認 -> *デフォルト: 部分一致*)
- **処理対象**: 未処理のメールのみを対象とする（重複転記防止のため）。
    - *案: 処理済みメールには「GAS_Processed」等のラベルを付与し、検索条件に `-label:GAS_Processed` を追加する。*

### 2. データ抽出・加工
各メールから以下の情報を抽出する。
- **差出人 (From)**: メールヘッダーより取得。
- **内容サマリ (Body Summary)**:
    - *確認事項*: 「サマリ」の定義。
    - *暫定仕様*: 本文の先頭 200文字 を抽出（改行はスペースに置換するなど）。

### 3. スプレッドシート転記
- **対象シート**:
    - ID: `1XO-56rbZtiwbCYpnObHMWxjUw50kqxhCATaEanr-x5`
    - シート名: *要確認 (デフォルト: "シート1")*
- **出力カラム**:
    - **A列 (No)**: 連番 (現在の最終行 + 1, または行番号 - ヘッダー行数)
    - **B列 (差出人)**: 抽出した差出人
    - **C列 (内容)**: 抽出した内容サマリ

### 4. 実行トリガー
- *確認事項*: 自動実行か手動実行か。
- *推奨*: 時間主導型トリガー (例: 1時間に1回、または10分に1回)

## 非機能要件
- **エラーハンドリング**: 処理中にエラーが発生した場合、ログに出力する。
- **権限**: スクリプトは対象のGmailとスプレッドシートにアクセスできる権限を持つアカウントで実行されること。

## 決定事項 (Confirmed)
1. **実行タイミング**: 手動実行 (Manual Execution)
2. **重複防止**: 処理済みメールにラベル `Processed` を付与する。
3. **サマリの定義**: 本文の先頭 100文字。
4. **シート名**: `シート1`
